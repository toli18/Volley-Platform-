<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Volley Platform</title>
  <style>
    :root {
      --bg: #f4f4f4;
      --panel: #ffffff;
      --border: #ccc;
      --muted: #475569;
      --primary: #2563eb;
      --success: #16a34a;
      --warning: #f59e0b;
      --danger: #ef4444;
      --info: #0ea5e9;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
    }

    * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: var(--bg);
      margin: 0;
      padding: 0;
      color: #0f172a;
    }

    header {
      background: #ddd;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    nav {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    nav a {
      text-decoration: none;
      color: #333;
      font-weight: 600;
      padding: 6px 10px;
      border-radius: 6px;
    }

    nav a:hover,
    nav a:focus-visible {
      background: #cfcfcf;
      outline: none;
    }

    .hero {
      background: #e0e0e0;
      padding: 40px 20px;
      text-align: center;
      margin-bottom: 20px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card {
      background: var(--panel);
      padding: 20px;
      border: 1px solid var(--border);
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04);
    }

    .card .meta {
      color: var(--muted);
      font-size: 0.9rem;
      margin-top: 4px;
    }

    /* Live demo section */
    .live-demo {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: var(--panel);
      border-radius: 16px;
      box-shadow: var(--shadow);
    }

    .demo-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px;
      align-items: end;
      margin-bottom: 16px;
    }

    .control-stack {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .demo-controls input {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      min-width: 100%;
    }

    .demo-controls .demo-hint {
      margin: 0;
      color: var(--muted);
      font-size: 0.9rem;
    }

    .control-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .demo-controls button {
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      background: var(--primary);
      color: #fff;
      cursor: pointer;
      font-weight: 700;
    }

    .demo-controls button.ghost-btn {
      background: #e2e8f0;
      color: #0f172a;
      border: 1px solid #cbd5e1;
    }

    .demo-controls button:focus-visible,
    .demo-controls button:hover {
      opacity: 0.92;
    }

    .demo-status-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .demo-status {
      color: var(--muted);
      font-size: 0.95rem;
    }

    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
    }

    .block-header {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: flex-start;
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      width: 100%;
    }

    .filter-row input,
    .filter-row select {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: #f8fafc;
      min-width: 120px;
    }

    .filter-row input {
      flex: 1 1 160px;
    }

    .demo-grid h3 {
      margin-top: 0;
    }

    .role-preview {
      margin-top: 20px;
      background: #fff;
      border-radius: 18px;
      padding: 16px;
      border: 1px solid #e2e8f0;
      box-shadow: var(--shadow);
      display: grid;
      gap: 14px;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      align-items: start;
    }

    .role-preview .role-meta {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .role-preview select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      font-size: 0.95rem;
    }

    .role-preview ul {
      margin: 0 0 6px 0;
      padding-left: 16px;
      color: var(--muted);
    }

    .role-preview h4 {
      margin: 0;
      color: #0f172a;
    }

    .demo-block {
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
      background: #f8fafc;
    }

    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 6px 0 0;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.85rem;
      background: #e2e8f0;
      color: #0f172a;
    }

    footer {
      text-align: center;
      padding: 20px;
      background: #ddd;
      margin-top: 40px;
    }

    /* Methodology & Articles */
    .methodology {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .layout-two-col {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 20px;
    }

    .filters {
      background: var(--panel);
      padding: 20px;
      border-radius: 18px;
      box-shadow: var(--shadow);
      display: grid;
      gap: 12px;
    }

    .filter-group {
      display: grid;
      gap: 6px;
      color: var(--muted);
      font-weight: 600;
    }

    .filter-box,
    .filters input,
    .filters select {
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      font-size: 0.95rem;
    }

    /* Forum */
    .forum,
    .my-trainings,
    .training-generator,
    .exercise-detail {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }

    /* Exercise detail */
    .exercise-card {
      background: var(--panel);
      padding: 24px;
      border-radius: 18px;
      box-shadow: var(--shadow);
    }

    .exercise-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .media-box {
      background: #f1f5f9;
      border-radius: 16px;
      height: 260px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--muted);
      font-weight: 600;
    }

    .pill-btn {
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      background: var(--primary);
      color: #fff;
      cursor: pointer;
      font-weight: 700;
    }

    .pill-btn.success {
      background: var(--success);
    }

    .pill-btn.ghost {
      background: #e2e8f0;
      color: #0f172a;
      border: 1px solid #cbd5e1;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.85rem;
      font-weight: 700;
      background: #e2e8f0;
      color: #0f172a;
    }

    .badge.success { background: #dcfce7; color: #166534; }
    .badge.warning { background: #fef9c3; color: #92400e; }
    .badge.danger { background: #fee2e2; color: #991b1b; }
    .badge.info { background: #e0f2fe; color: #075985; }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 10px;
    }

    /* Roles */
    .roles {
      max-width: 1200px;
      margin: 40px auto;
      padding: 0 20px;
    }

    .role-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }

    .role-card {
      background: var(--panel);
      padding: 20px;
      border-radius: 14px;
      border: 1px solid #e2e8f0;
      box-shadow: var(--shadow);
    }

    .role-card h3 {
      margin-top: 0;
      margin-bottom: 8px;
    }

    .role-card h4 {
      margin-bottom: 6px;
      color: var(--muted);
    }

    .role-card ul {
      padding-left: 18px;
      margin-top: 4px;
      margin-bottom: 12px;
      color: #0f172a;
    }

    .flow {
      background: var(--panel);
      padding: 20px;
      border-radius: 14px;
      border: 1px solid #e2e8f0;
      box-shadow: var(--shadow);
      margin-top: 20px;
    }

    /* Generator */
    .training-layout {
      display: grid;
      grid-template-columns: 320px 1fr;
      gap: 20px;
    }

    .panel {
      background: var(--panel);
      padding: 20px;
      border-radius: 18px;
      box-shadow: var(--shadow);
      border: 1px solid #e2e8f0;
    }

    .panel label {
      display: block;
      margin: 12px 0 6px;
      font-weight: 600;
      color: var(--muted);
    }

    .panel select,
    .panel input {
      width: 100%;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
      font-size: 0.95rem;
    }

    .toast-area {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: grid;
      gap: 10px;
      z-index: 999;
      width: min(360px, 90vw);
    }

    .toast {
      background: #0f172a;
      color: #fff;
      padding: 12px 14px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .toast.success {
      background: #166534;
    }

    .toast.error {
      background: #b91c1c;
    }

    .toast.info {
      background: #0ea5e9;
      color: #0b2c3c;
    }

    @media (max-width: 960px) {
      .layout-two-col,
      .training-layout {
        grid-template-columns: 1fr;
      }

      header {
        justify-content: center;
      }

      nav {
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <header>
    <div><strong>LOGO</strong></div>
    <nav>
      <a href="#home">–ù–∞—á–∞–ª–æ</a>
      <a href="#exercises">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</a>
      <a href="#generator">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</a>
      <a href="#my-trainings">–ú–æ–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</a>
      <a href="#methodology">–ú–µ—Ç–æ–¥–∏–∫–∞</a>
      <a href="#forum">–û–±—â–Ω–æ—Å—Ç</a>
      <a href="#settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
    </nav>
  </header>

  <main>
    <section class="hero" id="home">
      <h1>–î–æ–±—Ä–µ –¥–æ—à–ª–∏ –≤ Volley Platform</h1>
      <p>–ï–¥–∏–Ω–Ω–∞—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –∑–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –º–µ—Ç–æ–¥–∏–∫–∞ –ø–æ –≤–æ–ª–µ–π–±–æ–ª</p>
    </section>

    <section class="live-demo" aria-label="Mock API –¥–µ–º–æ">
      <h2 style="margin-top:0">–î–µ–º–æ —Å Mock API</h2>
      <p class="demo-status">–¢–µ—Å—Ç–≤–∞–π —Ä–æ–ª–∏, —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è —Å –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç <code>prototype/mock_api.py</code>.</p>
      <div class="demo-controls">
        <div class="control-stack">
          <label for="api-url">API URL</label>
          <input id="api-url" name="api-url" value="http://localhost:8001" aria-label="–ë–∞–∑–æ–≤ URL –Ω–∞ API" />
          <p id="api-hint" class="demo-hint" aria-live="polite">–ê–≤—Ç–æ-–ø–æ–ø—ä–ª–≤–∞–Ω–µ —Å–ø–æ—Ä–µ–¥ —Ç–µ–∫—É—â–∏—è –¥–æ–º–µ–π–Ω</p>
        </div>
        <div class="control-actions">
          <button id="load-data" type="button">–ó–∞—Ä–µ–¥–∏ –¥–∞–Ω–Ω–∏</button>
          <button id="reset-api" type="button" class="ghost-btn">–ò–∑—á–∏—Å—Ç–∏ / –ª–æ–∫–∞–ª–µ–Ω</button>
        </div>
        <div class="demo-status-row">
          <span id="api-state" class="demo-status" aria-live="polite"></span>
          <span id="api-updated" class="demo-status" aria-live="polite">–ü–æ—Å–ª–µ–¥–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ: ‚Äî</span>
          <span id="active-role-badge" class="demo-status" aria-live="polite" style="font-weight:700;">–†–æ–ª—è: coach</span>
          <span id="offline-flag" class="demo-status" aria-live="polite"></span>
        </div>
      </div>
      <div class="demo-grid">
        <div class="demo-block">
          <div class="block-header">
            <h3 style="margin:0">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
            <div class="filter-row" aria-label="–§–∏–ª—Ç—Ä–∏ –∑–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è">
              <input type="text" id="exercise-search" placeholder="–¢—ä—Ä—Å–∏ –ø–æ –∏–º–µ" aria-label="–¢—ä—Ä—Å–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è" />
              <select id="exercise-status" aria-label="–°—Ç–∞—Ç—É—Å –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
                <option value="all">–í—Å–∏—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∏</option>
                <option value="approved">Approved</option>
                <option value="pending">Pending</option>
                <option value="draft">Draft</option>
              </select>
              <select id="exercise-category" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
                <option value="all">–í—Å–∏—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
              </select>
            </div>
          </div>
          <div id="api-exercises" class="badge-row" aria-live="polite"></div>
        </div>
        <div class="demo-block">
          <h3>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
          <div id="api-trainings" class="badge-row" aria-live="polite"></div>
        </div>
        <div class="demo-block">
          <div class="block-header">
            <h3 style="margin:0">–ö–ª—É–±–æ–≤–µ</h3>
            <div class="filter-row" aria-label="–§–∏–ª—Ç—ä—Ä –∑–∞ –∫–ª—É–±–æ–≤–µ">
              <select id="club-status" aria-label="–°—Ç–∞—Ç—É—Å –Ω–∞ –∫–ª—É–±">
                <option value="all">–í—Å–∏—á–∫–∏ —Å—Ç–∞—Ç—É—Å–∏</option>
                <option value="active">Active</option>
                <option value="pending">Pending</option>
              </select>
            </div>
          </div>
          <div id="api-clubs" class="badge-row" aria-live="polite"></div>
        </div>
        <div class="demo-block">
          <div class="block-header">
            <h3 style="margin:0">–ß–∞–∫–∞—â–∏ –æ–¥–æ–±—Ä–µ–Ω–∏—è</h3>
            <div class="filter-row" aria-label="–§–∏–ª—Ç—ä—Ä –∑–∞ –æ–¥–æ–±—Ä–µ–Ω–∏—è">
              <select id="pending-type" aria-label="–¢–∏–ø –Ω–∞ —á–∞–∫–∞—â–∏">
                <option value="all">–í—Å–∏—á–∫–∏ —Ç–∏–ø–æ–≤–µ</option>
                <option value="exercise">–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</option>
                <option value="article">–°—Ç–∞—Ç–∏–∏</option>
                <option value="forum">–§–æ—Ä—É–º</option>
              </select>
            </div>
          </div>
          <div id="api-pending" class="badge-row" aria-live="polite"></div>
          <div style="margin-top:12px; text-align:left;">
            <div class="filter-row" aria-label="–ü—Ä–µ–¥–ª–æ–∂–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
              <input type="text" id="propose-name" placeholder="–ò–º–µ –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ" aria-label="–ò–º–µ –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ" />
              <select id="propose-category" aria-label="–ö–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
                <option value="–ü–æ–¥–∞–≤–∞–Ω–µ">–ü–æ–¥–∞–≤–∞–Ω–µ</option>
                <option value="–ë–ª–æ–∫">–ë–ª–æ–∫</option>
                <option value="–°–µ—Ä–≤–∏—Å">–°–µ—Ä–≤–∏—Å</option>
                <option value="–û–±—â–æ">–û–±—â–æ</option>
              </select>
              <button id="btn-propose" type="button">–ü—Ä–µ–¥–ª–æ–∂–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</button>
            </div>
            <div id="pending-actions" class="badge-row" style="margin-top:8px; text-align:left; display:grid; gap:8px;">
            </div>
          </div>
        </div>
        <div class="demo-block">
          <h3>–ü—Ä–∞–≤–∞ –ø–æ —Ä–æ–ª–∏</h3>
          <div id="api-roles" class="badge-row" aria-live="polite"></div>
        </div>
      </div>

      <div class="role-preview" aria-label="–ü—Ä–µ–≥–ª–µ–¥ –ø–æ —Ä–æ–ª—è">
        <div class="role-meta">
          <h3 style="margin:0">–ü—Ä–µ–≥–ª–µ–¥ –ø–æ —Ä–æ–ª—è</h3>
          <p class="demo-status" style="margin:0">–ó–∞—Ä–µ–¥–∏ –ø—Ä–∞–≤–∞ –æ—Ç API –∏–ª–∏ –ø–æ–ª–∑–≤–∞–π –ø—Ä–∏–º–µ—Ä–Ω–∏—Ç–µ, –∑–∞ –¥–∞ –≤–∏–¥–∏—à –∫–∞–∫–≤–æ –º–æ–∂–µ –≤—Å—è–∫–∞ —Ä–æ–ª—è.</p>
          <label for="role-select" style="font-weight:600; color:#0f172a;">–ò–∑–±–µ—Ä–∏ —Ä–æ–ª—è</label>
          <select id="role-select" aria-label="–ò–∑–±–æ—Ä –Ω–∞ —Ä–æ–ª—è">
            <option value="platform_admin">platform_admin</option>
            <option value="bfv_admin">bfv_admin</option>
            <option value="coach">coach</option>
          </select>
          <p id="role-source" class="demo-status" style="margin:0;">–ò–∑—Ç–æ—á–Ω–∏–∫: –ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏</p>
        </div>
        <div id="role-detail" class="demo-block" style="background:#fff; box-shadow:none; border:1px solid var(--border);" aria-live="polite">
          <h4>–ü—Ä–∞–≤–∞</h4>
          <ul id="role-can"></ul>
          <h4>–ö–ª—é—á–æ–≤–∏ –¥–µ–π—Å—Ç–≤–∏—è</h4>
          <ul id="role-actions"></ul>
        </div>
      </div>
    </section>

    <section class="coach-beta" aria-label="–ö–ª—É–±–µ–Ω —Ç–µ—Å—Ç –∑–∞ —Ç—Ä–µ–Ω—å–æ—Ä–∏">
      <div style="background:#0ea5e9;color:#0b2c3c;border-radius:18px;padding:20px;box-shadow:0 10px 30px rgba(14,165,233,0.2);display:grid;grid-template-columns:1fr;gap:12px;">
        <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
          <div style="background:#e0f2fe;color:#0b2c3c;padding:10px 14px;border-radius:12px;font-weight:700;">–ö–ª—É–±–µ–Ω —Ç–µ—Å—Ç ¬∑ Coach beta</div>
          <p style="margin:0;font-size:0.95rem;max-width:760px;">–ì–æ—Ç–æ–≤ –∫–æ–º–ø–ª–µ–∫—Ç –∑–∞ —Å–ø–æ–¥–µ–ª—è–Ω–µ —Å —Ç—Ä–µ–Ω—å–æ—Ä–∏: –ª–∏–Ω–∫ –∫—ä–º UI + –∂–∏–≤–æ API (–∏–ª–∏ fallback), –∫—Ä–∞—Ç–∫–∏ —Å—Ç—ä–ø–∫–∏ –∏ –∫–∞–∫–≤–æ –¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç.</p>
        </div>
        <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;align-items:start;">
          <div style="background:#e0f2fe;color:#0b2c3c;padding:12px 14px;border-radius:14px;">
            <div style="font-weight:700;margin-bottom:6px;">–°—Ç—ä–ø–∫–∞ 1: –°–ø–æ–¥–µ–ª–∏ –ª–∏–Ω–∫–∞</div>
            <p style="margin:6px 0;font-size:0.95rem;">1) –ê–∫–æ UI –∏ API —Å–∞ –Ω–∞ –µ–¥–∏–Ω –¥–æ–º–µ–π–Ω (–Ω–∞–ø—Ä. Render –ø—Ä–æ—Ü–µ—Å), –∫–æ–ø–∏—Ä–∞–π –ø—É–±–ª–∏—á–Ω–∏—è URL –∏ –≥–æ –∏–∑–ø—Ä–∞—Ç–∏ –Ω–∞ —Ç—Ä–µ–Ω—å–æ—Ä–∏—Ç–µ.<br>2) –ê–∫–æ UI –µ –æ—Ç–¥–µ–ª–Ω–æ, –¥–æ–±–∞–≤–∏ –∞–¥—Ä–µ—Å–∞ –Ω–∞ API –≤ –ø–æ–ª–µ—Ç–æ ‚Äû–ê–¥—Ä–µ—Å –Ω–∞ API‚Äú.</p>
          </div>
          <div style="background:#e0f2fe;color:#0b2c3c;padding:12px 14px;border-radius:14px;">
            <div style="font-weight:700;margin-bottom:6px;">–°—Ç—ä–ø–∫–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ —Ç—Ä–µ–Ω—å–æ—Ä–∞</div>
            <p style="margin:6px 0;font-size:0.95rem;">‚Äì –û—Ç–≤–æ—Ä–∏ ‚Äû–î–µ–º–æ —Å Mock API‚Äú –∏ –Ω–∞—Ç–∏—Å–Ω–∏ ‚Äû–ó–∞—Ä–µ–¥–∏ –¥–∞–Ω–Ω–∏‚Äú (–∏–ª–∏ –∏–∑—á–∞–∫–∞–π –∞–≤—Ç–æ-–∑–∞—Ä–µ–∂–¥–∞–Ω–µ).<br>‚Äì –£–≤–µ—Ä–∏ —Å–µ, —á–µ –∫–ª—É–±–æ–≤–µ—Ç–µ —Å–µ –ø–æ–∫–∞–∑–≤–∞—Ç —Å—ä—Å —Å—Ç–∞—Ç—É—Å–∏ –∏ –ª–∏–º–∏—Ç–∏; —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è—Ç–∞ –∏–º–∞—Ç —Å—Ç–∞—Ç—É—Å–∏ Approved/Pending/Draft.</p>
          </div>
          <div style="background:#e0f2fe;color:#0b2c3c;padding:12px 14px;border-radius:14px;">
            <div style="font-weight:700;margin-bottom:6px;">–°—Ç—ä–ø–∫–∞ 3: –ú–∏–Ω–∏-—Å—Ü–µ–Ω–∞—Ä–∏–∏</div>
            <ul style="margin:6px 0 0 16px;padding:0;font-size:0.95rem;line-height:1.5;">
              <li>Coach: –ø—Ä–µ–¥–ª–æ–∂–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ (–≤–∏–∂ —Å—Ç–∞—Ç—É—Å ‚Äû–ß–∞–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ‚Äú).</li>
              <li>bfv_admin: –æ–¥–æ–±—Ä–∏/–æ—Ç–∫–∞–∂–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–±–ª—é–¥–∞–≤–∞–π –ø—Ä–æ–º—è–Ω–∞—Ç–∞).</li>
              <li>–ü—Ä–æ–≤–µ—Ä–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏/–∫–ª—É–±–æ–≤–µ –∏ —Ä–æ–ª–∏—Ç–µ –≤ ‚Äû–ü—Ä–µ–≥–ª–µ–¥ –ø–æ —Ä–æ–ª—è‚Äú.</li>
            </ul>
          </div>
          <div style="background:#e0f2fe;color:#0b2c3c;padding:12px 14px;border-radius:14px;display:grid;gap:6px;">
            <div style="font-weight:700;">–°—Ç–∞—Ç—É—Å –Ω–∞ —Å—Ä–µ–¥–∞—Ç–∞</div>
            <div id="coachBetaStatus" style="display:flex;align-items:center;gap:8px;font-size:0.95rem;flex-wrap:wrap;"></div>
            <p style="margin:0;font-size:0.85rem;color:#164e63;">–õ–µ–Ω—Ç–∞—Ç–∞ ‚Äû–ü–æ—Å–ª–µ–¥–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ‚Äú (–Ω–∞–¥ –ø–∞–Ω–µ–ª–∏—Ç–µ) —Å—ä—â–æ –ø–æ–∫–∞–∑–≤–∞ –¥–∞–ª–∏ –¥–∞–Ω–Ω–∏—Ç–µ –∏–¥–≤–∞—Ç –æ—Ç API –∏–ª–∏ fallback.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="roles" aria-label="–†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞">
      <h2>–†–æ–ª–∏ –≤ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞</h2>
      <div class="role-grid">
        <div class="role-card">
          <h3>platform_admin</h3>
          <h4>–ú–æ–∂–µ:</h4>
          <ul>
            <li>–°—ä–∑–¥–∞–≤–∞/–æ–¥–æ–±—Ä—è–≤–∞ –∫–ª—É–±–æ–≤–µ</li>
            <li>–°—ä–∑–¥–∞–≤–∞ –∏ —É–ø—Ä–∞–≤–ª—è–≤–∞ —Ä–æ–ª–∏ bfv_admin</li>
            <li>–û–¥–æ–±—Ä—è–≤–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∑–∞ –æ–±—â–∞—Ç–∞ –±–∞–∑–∞</li>
            <li>–£–ø—Ä–∞–≤–ª—è–≤–∞ –º–µ—Ç–æ–¥–∏–∫–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –≥–ª–æ–±–∞–ª–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
            <li>–£–ø—Ä–∞–≤–ª—è–≤–∞ —Ñ–æ—Ä—É–º–∞ –Ω–∞ –Ω–∏–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
            <li>–í–∏–∂–¥–∞ –≤—Å–∏—á–∫–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–ª—É–±–æ–≤–µ –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</li>
          </ul>
          <h4>–ù–µ –º–æ–∂–µ:</h4>
          <ul>
            <li>–î–∞ —Å–µ –Ω–∞–º–µ—Å–≤–∞ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏—Ç–µ –Ω–∞ –∫–ª—É–±–æ–≤–µ—Ç–µ (–æ—Å–≤–µ–Ω —á–µ—Ç–µ–Ω–µ)</li>
          </ul>
        </div>
        <div class="role-card">
          <h3>bfv_admin</h3>
          <h4>–ú–æ–∂–µ:</h4>
          <ul>
            <li>–£–ø—Ä–∞–≤–ª—è–≤–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –≤ –∫–ª—É–±–æ–≤–µ—Ç–µ (–¥–æ–±–∞–≤—è —Ç—Ä–µ–Ω—å–æ—Ä–∏, –ª–∏–º–∏—Ç –¥–æ 4)</li>
            <li>–û–¥–æ–±—Ä—è–≤–∞ –Ω–æ–≤–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏ –æ—Ç —Ç—Ä–µ–Ω—å–æ—Ä–∏—Ç–µ</li>
            <li>–ü—É–±–ª–∏–∫—É–≤–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞ –∏ –ø—Ä–µ–º–∞—Ö–≤–∞ —Å—Ç–∞—Ç–∏–∏</li>
            <li>–ú–æ–¥–µ—Ä–∏—Ä–∞ —Ñ–æ—Ä—É–º–∞ (—Ç—Ä–∏–µ –ø–æ—Å—Ç–æ–≤–µ, –±–ª–æ–∫–∏—Ä–∞ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏)</li>
            <li>–í–∏–∂–¥–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ –∫–ª—É–±–æ–≤–µ, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç</li>
          </ul>
          <h4>–ù–µ –º–æ–∂–µ:</h4>
          <ul>
            <li>–î–∞ –ø—Ä–æ–º–µ–Ω—è —Å–∏—Å—Ç–µ–º–Ω–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
            <li>–î–∞ —Å—ä–∑–¥–∞–≤–∞ –Ω–æ–≤–∏ –∫–ª—É–±–æ–≤–µ</li>
          </ul>
        </div>
        <div class="role-card">
          <h3>coach</h3>
          <h4>–ú–æ–∂–µ:</h4>
          <ul>
            <li>–í–∏–∂–¥–∞ –∏ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞ –æ–±—â–∞—Ç–∞ –±–∞–∑–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</li>
            <li>–ì–µ–Ω–µ—Ä–∏—Ä–∞ –∏ —Å—ä–∑–¥–∞–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (—Ä—ä—á–Ω–æ –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)</li>
            <li>–ó–∞–ø–∞–∑–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∑–∞ —Å–≤–æ—è –∫–ª—É–±</li>
            <li>–ü—Ä–µ–¥–ª–∞–≥–∞ –Ω–æ–≤–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è (—á–∞–∫–∞—Ç –æ–¥–æ–±—Ä–µ–Ω–∏–µ –æ—Ç bfv_admin)</li>
            <li>–ü–∏—à–µ –≤—ä–≤ —Ñ–æ—Ä—É–º–∞: —Ç–µ–º–∏, –≤—ä–ø—Ä–æ—Å–∏, –∫–æ–º–µ–Ω—Ç–∞—Ä–∏</li>
          </ul>
          <h4>–ù–µ –º–æ–∂–µ:</h4>
          <ul>
            <li>–î–∞ –ø—É–±–ª–∏–∫—É–≤–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏ –≤ –º–µ—Ç–æ–¥–∏–∫–∞—Ç–∞</li>
            <li>–î–∞ —Å—ä–∑–¥–∞–≤–∞ –Ω–æ–≤–∏ –∫–ª—É–±–æ–≤–µ</li>
            <li>–î–∞ –≤–∏–∂–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –¥—Ä—É–≥–∏ –∫–ª—É–±–æ–≤–µ</li>
          </ul>
        </div>
      </div>
      <div class="flow" aria-label="–†–∞–±–æ—Ç–µ–Ω –ø–æ—Ç–æ–∫ –ø–æ —Ä–æ–ª–∏">
        <h3>–ö–∞–∫ —Ä–∞–±–æ—Ç–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ç–∞?</h3>
        <ul>
          <li><strong>platform_admin</strong>: —Å—ä–∑–¥–∞–≤–∞ –∫–ª—É–±, –Ω–∞–∑–Ω–∞—á–∞–≤–∞ bfv_admin, –æ–¥–æ–±—Ä—è–≤–∞ ‚Äû–æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏‚Äú —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–∞ –º–µ—Ç–æ–¥–∏–∫–∞—Ç–∞.</li>
          <li><strong>bfv_admin</strong>: –ø–æ–ª—É—á–∞–≤–∞ –∑–∞—è–≤–∫–∏ –∑–∞ –∫–ª—É–±/—Ç—Ä–µ–Ω—å–æ—Ä, –¥–æ–±–∞–≤—è —Ç—Ä–µ–Ω—å–æ—Ä–∏ (–¥–æ 4), –æ–¥–æ–±—Ä—è–≤–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –ø—É–±–ª–∏–∫—É–≤–∞ —Å—Ç–∞—Ç–∏–∏ –∏ –≥–∏ –º–æ–¥–µ—Ä–∏—Ä–∞.</li>
          <li><strong>coach</strong>: —Ä–∞–∑–≥–ª–µ–∂–¥–∞ –æ–±—â–∞—Ç–∞ –±–∞–∑–∞, –≥–µ–Ω–µ—Ä–∏—Ä–∞ –∏ –∑–∞–ø–∞–∑–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø–∏—à–µ –≤—ä–≤ —Ñ–æ—Ä—É–º–∞, –ø—Ä–µ–¥–ª–∞–≥–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏ –∑–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ.</li>
        </ul>
      </div>
    </section>

    <section class="grid" aria-label="–û—Å–Ω–æ–≤–Ω–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∏ –∫–∞—Ä—Ç–∏">
      <div class="card" id="exercises">
        <h3>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
        <p>–†–∞–∑–≥–ª–µ–¥–∞–π –ø—ä–ª–Ω–∞—Ç–∞ –±–∞–∑–∞ —Å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</p>
        <p class="meta">–ü—Ä–∏–º–µ—Ä: 620 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –≥—Ä—É–ø–∏—Ä–∞–Ω–∏ –ø–æ —Ç–µ—Ö–Ω–∏–∫–∞/—Ç–∞–∫—Ç–∏–∫–∞.</p>
      </div>
      <div class="card" id="generator">
        <h3>–ì–µ–Ω–µ—Ä–∏—Ä–∞–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</h3>
        <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–ª–∏ —Ä—ä—á–Ω–æ —Å—ä–∑–¥–∞–≤–∞–Ω–µ</p>
        <p class="meta">–ò–∑–±–µ—Ä–∏ –≤—ä–∑—Ä–∞—Å—Ç, —Ü–µ–ª–∏, –ø—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç.</p>
      </div>
      <div class="card" id="methodology">
        <h3>–ú–µ—Ç–æ–¥–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏–∏</h3>
        <p>–°—ä–±—Ä–∞–Ω–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∏ –∏ –Ω–∞—Å–æ–∫–∏</p>
        <p class="meta">–°—Ç–∞—Ç–∏–∏, –≤–∏–¥–µ–æ, PDF —Ä–µ—Å—É—Ä—Å–∏.</p>
      </div>
    </section>

    <section class="grid" aria-label="–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∏ –∫–∞—Ä—Ç–∏">
      <div class="card" id="my-trainings">
        <h3>–ú–æ–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h3>
        <p>–ó–∞–ø–∞–∑–µ–Ω–∏ —Å–µ—Å–∏–∏ –∑–∞ –±—ä–¥–µ—â–æ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ</p>
      </div>
      <div class="card" id="forum">
        <h3>–§–æ—Ä—É–º / –û–±—â–Ω–æ—Å—Ç</h3>
        <p>–û–±–º—è–Ω–∞ –Ω–∞ –∏–¥–µ–∏ –∏ –≤—ä–ø—Ä–æ—Å–∏ –º–µ–∂–¥—É —Ç—Ä–µ–Ω—å–æ—Ä–∏</p>
      </div>
    </section>

    <section class="methodology" aria-label="–ú–µ—Ç–æ–¥–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏–∏">
      <h2>–ú–µ—Ç–æ–¥–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏–∏</h2>
      <div class="layout-two-col">
        <aside class="filters" aria-label="–§–∏–ª—Ç—Ä–∏">
          <h3>–§–∏–ª—Ç—Ä–∏</h3>
          <div class="filter-group">
            <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
            <select id="category" class="filter-box">
              <option>–¢–µ—Ö–Ω–∏–∫–∞</option>
              <option>–¢–∞–∫—Ç–∏–∫–∞</option>
              <option>–§–∏–∑–∏—á–µ—Å–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="level">–ù–∏–≤–æ</label>
            <select id="level" class="filter-box">
              <option>–í—Å–∏—á–∫–∏</option>
              <option>–ù–∞—á–∏–Ω–∞–µ—â–∏</option>
              <option>–°—Ä–µ–¥–Ω–æ</option>
              <option>–ù–∞–ø—Ä–µ–¥–Ω–∞–ª–∏</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="type">–¢–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª</label>
            <select id="type" class="filter-box">
              <option>–°—Ç–∞—Ç–∏—è</option>
              <option>–í–∏–¥–µ–æ</option>
              <option>PDF</option>
            </select>
          </div>
          <div class="filter-group">
            <label for="search">–¢—ä—Ä—Å–µ–Ω–µ</label>
            <input id="search" type="text" class="filter-box" placeholder="–¢—ä—Ä—Å–∏ —Å—Ç–∞—Ç–∏–∏..." />
          </div>
        </aside>
        <main>
          <div class="grid">
            <div class="card" style="text-align: left;">
              <div class="badge success">–ü—É–±–ª–∏–∫—É–≤–∞–Ω–æ</div>
              <h3>–¢–∞–∫—Ç–∏—á–µ—Å–∫–æ –ø–æ–¥—Ä–µ–∂–¥–∞–Ω–µ 5‚Äì1</h3>
              <p style="color: var(--muted); font-size: 0.95rem;">–°—Ç—ä–ø–∫–∏, –¥–∏–∞–≥—Ä–∞–º–∏ –∏ –≤–∏–¥–µ–æ –∑–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—è –∏ –∫—Ä–∞–π–Ω–∏ –Ω–∞–ø–∞–¥–∞—Ç–µ–ª–∏.</p>
              <p class="meta">–¢–∏–ø: –í–∏–¥–µ–æ ‚Ä¢ –ù–∏–≤–æ: U16+</p>
            </div>
            <div class="card" style="text-align: left;">
              <div class="badge warning">–ß–∞–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ (bfv_admin)</div>
              <h3>–ü—Ä–æ–≥—Ä–∞–º–∞ –∑–∞ —Å–∏–ª–æ–≤–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
              <p style="color: var(--muted); font-size: 0.95rem;">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ –æ—Ç coach: 4-—Å–µ–¥–º–∏—á–µ–Ω —Ü–∏–∫—ä–ª —Å –∞–∫—Ü–µ–Ω—Ç –≤—ä—Ä—Ö—É —Å—Ç–∞–±–∏–ª–Ω–æ—Å—Ç –∏ –µ–∫—Å–ø–ª–æ–∑–∏–≤–Ω–æ—Å—Ç.</p>
              <p class="meta">–¢–∏–ø: PDF ‚Ä¢ –ù–∏–≤–æ: U18</p>
            </div>
            <div class="card" style="text-align: left;">
              <div class="badge info">–ß–µ—Ä–Ω–æ–≤–∞</div>
              <h3>–ú–µ—Ç–æ–¥–∏–∫–∞ –∑–∞ –ø—Ä–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–∏—Å</h3>
              <p style="color: var(--muted); font-size: 0.95rem;">–®–∞–±–ª–æ–Ω, –∫–æ–π—Ç–æ platform_admin –¥–æ—Ä–∞–±–æ—Ç–≤–∞ –ø—Ä–µ–¥–∏ –ø—É–±–ª–∏–∫—É–≤–∞–Ω–µ.</p>
              <p class="meta">–¢–∏–ø: –°—Ç–∞—Ç–∏—è ‚Ä¢ –ù–∏–≤–æ: –í—Å–∏—á–∫–∏</p>
            </div>
          </div>
        </main>
      </div>
    </section>

    <section class="grid" aria-label="–î–µ–º–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å —Ä–æ–ª–∏" style="max-width: 1200px; margin: 40px auto;">
      <div class="card" style="text-align: left;">
        <div class="badge success">–û–¥–æ–±—Ä–µ–Ω–æ</div>
        <h3>–ü–æ–¥–∞–≤–∞–Ω–µ –≤ –∑–æ–Ω–∞ 4</h3>
        <p class="meta">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –¢–µ—Ö–Ω–∏–∫–∞ ‚Ä¢ –ù–∏–≤–æ: U14</p>
        <div class="tag-row">
          <span class="badge info">–î–æ–±–∞–≤–µ–Ω–æ –æ—Ç: platform_admin</span>
          <span class="badge">–í—Ä–µ–º–µ: 10 –º–∏–Ω</span>
        </div>
      </div>
      <div class="card" style="text-align: left;">
        <div class="badge warning">–ß–∞–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ</div>
        <h3>–ë—ä—Ä–∑–æ –Ω–∞–ø–∞–¥–µ–Ω–∏–µ —Å–ª–µ–¥ –ø—Ä–∏–µ–º</h3>
        <p class="meta">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: –¢–∞–∫—Ç–∏–∫–∞ ‚Ä¢ –ù–∏–≤–æ: U16</p>
        <div class="tag-row">
          <span class="badge info">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –æ—Ç: coach</span>
          <span class="badge">–ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç: –°—Ä–µ–¥–Ω–∞</span>
        </div>
      </div>
      <div class="card" style="text-align: left;">
        <div class="badge danger">–í—ä—Ä–Ω–∞—Ç–æ –∑–∞ —Ä–µ–¥–∞–∫—Ü–∏—è</div>
        <h3>–°–µ—Ä–≤–∏—Å–∏ –∫—ä–º –∑–æ–Ω–∏ 1/5</h3>
        <p class="meta">–ö–æ–º–µ–Ω—Ç–∞—Ä bfv_admin: –ª–∏–ø—Å–≤–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç –∑–∞ U12</p>
        <div class="tag-row">
          <span class="badge">–ù–∏–≤–æ: U12</span>
          <span class="badge info">–û—Ç: coach</span>
        </div>
      </div>
    </section>

    <section class="forum" aria-label="–§–æ—Ä—É–º –∏ –æ–±—â–Ω–æ—Å—Ç">
      <h2>–§–æ—Ä—É–º / –û–±—â–Ω–æ—Å—Ç</h2>
      <div class="grid">
        <div class="card"><h3>–¢—Ä–µ–Ω–∏—Ä–æ–≤—ä—á–µ–Ω –ø—Ä–æ—Ü–µ—Å</h3><p style="color: var(--muted); font-size: 0.9rem;">–¢–µ–º–∏: 32 ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–æ: –≤—á–µ—Ä–∞</p></div>
        <div class="card"><h3>–¢–∞–∫—Ç–∏—á–µ—Å–∫–æ –æ–±—É—á–µ–Ω–∏–µ</h3><p style="color: var(--muted); font-size: 0.9rem;">–¢–µ–º–∏: 18 ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–æ: –¥–Ω–µ—Å</p></div>
        <div class="card"><h3>–†–∞–±–æ—Ç–∞ —Å –¥–µ—Ü–∞</h3><p style="color: var(--muted); font-size: 0.9rem;">–¢–µ–º–∏: 25 ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–æ: 3 –¥–Ω–∏</p></div>
        <div class="card"><h3>–ü—Ä–æ–±–ª–µ–º–∏ –∏ —Ä–µ—à–µ–Ω–∏—è</h3><p style="color: var(--muted); font-size: 0.9rem;">–¢–µ–º–∏: 9 ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–æ: 1 –¥–µ–Ω</p></div>
        <div class="card"><h3>–°–ø–æ–¥–µ–ª—è–Ω–µ –Ω–∞ —Ä–µ—Å—É—Ä—Å–∏</h3><p style="color: var(--muted); font-size: 0.9rem;">–¢–µ–º–∏: 11 ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–æ: 5 –¥–Ω–∏</p></div>
      </div>
    </section>

    <section class="exercise-detail" aria-label="–î–µ—Ç–∞–π–ª –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ">
      <div class="exercise-card">
        <h2>–î–µ—Ç–∞–π–ª –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h2>
        <div class="exercise-grid">
          <div class="media-box">–í–∏–¥–µ–æ / –°–Ω–∏–º–∫–∞</div>
          <div>
            <h3>–ò–º–µ –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</h3>
            <p>–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ—Ç–æ...</p>
            <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> –ü–æ–¥–∞–≤–∞–Ω–µ</p>
            <p><strong>–ù–∏–≤–æ:</strong> –í—Å–∏—á–∫–∏</p>
            <p><strong>–ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç:</strong> –°—Ä–µ–¥–Ω–∞</p>
            <div class="tag-row">
              <span class="badge success">–û–¥–æ–±—Ä–µ–Ω–æ</span>
              <span class="badge">–î–æ–±–∞–≤–µ–Ω–æ –æ—Ç bfv_admin</span>
            </div>
            <button class="pill-btn" style="margin-top: 10px;">–î–æ–±–∞–≤–∏ –∫—ä–º —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
          </div>
        </div>
        <h4>–í–∞—Ä–∏–∞—Ü–∏–∏</h4>
        <ul>
          <li>–í–∞—Ä–∏–∞—Ü–∏—è 1</li>
          <li>–í–∞—Ä–∏–∞—Ü–∏—è 2</li>
        </ul>
      </div>
    </section>

    <section class="training-generator" aria-label="–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏">
      <h2>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
      <div class="training-layout">
        <aside class="panel" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞">
          <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
          <label for="age-group">–í—ä–∑—Ä–∞—Å—Ç–æ–≤–∞ –≥—Ä—É–ø–∞</label>
          <select id="age-group">
            <option>U12</option>
            <option>U14</option>
          </select>
          <label for="goal">–¶–µ–ª–∏ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</label>
          <select id="goal">
            <option>–¢–µ—Ö–Ω–∏–∫–∞</option>
            <option>–ê—Ç–∞–∫–∞</option>
          </select>
          <label for="duration">–ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç (–º–∏–Ω—É—Ç–∏)</label>
          <input id="duration" type="number" placeholder="60" />
          <button class="pill-btn" style="width: 100%; margin-top: 12px;">–ì–µ–Ω–µ—Ä–∏—Ä–∞–π</button>
        </aside>
        <main>
          <h3>–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h3>
          <div class="grid" style="margin-top: 10px;">
            <div class="card" style="text-align: left;">
              <div class="badge success">–ü–æ–¥—Ö–æ–¥—è—â–æ</div>
              <h3>–ë—ä—Ä–∑–æ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</h3>
              <p class="meta">–ù–∏–≤–æ: U14 ‚Ä¢ –ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç: 12 –º–∏–Ω</p>
            </div>
            <div class="card" style="text-align: left;">
              <div class="badge warning">–ü–æ-–≤–∏—Å–æ–∫–∞ –∏–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç</div>
              <h3>–¢–æ–ø–∫–∏ –æ—Ç –≤—Ç–æ—Ä–∞ –ª–∏–Ω–∏—è</h3>
              <p class="meta">–ù–∏–≤–æ: U16 ‚Ä¢ –ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç: 15 –º–∏–Ω</p>
            </div>
            <div class="card" style="text-align: left;">
              <div class="badge info">–û–ø—Ü–∏—è</div>
              <h3>–°–µ—Ä–≤–∏—Å–∏ –ø–æ–¥ –Ω–∞—Ç–∏—Å–∫</h3>
              <p class="meta">–ù–∏–≤–æ: U14 ‚Ä¢ –ü—Ä–æ–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ—Å—Ç: 10 –º–∏–Ω</p>
            </div>
          </div>
          <button class="pill-btn success" style="margin-top: 20px;">–ó–∞–ø–∞–∑–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</button>
        </main>
      </div>
    </section>

    <section class="my-trainings" aria-label="–ú–æ–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏">
      <h2>–ú–æ–∏—Ç–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>
      <div class="grid" style="margin-top: 20px;">
        <div class="card" style="text-align: left;">
          <h3>U14 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h3>
          <p class="meta">75 –º–∏–Ω ‚Ä¢ 6 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è ‚Ä¢ –∞–≤—Ç–æ—Ä: coach</p>
          <div class="tag-row">
            <span class="badge">–¶–µ–ª: –ü—Ä–∏–µ–º</span>
            <span class="badge info">–°—Ç–∞—Ç—É—Å: –ó–∞–ø–∞–∑–µ–Ω–∞</span>
          </div>
        </div>
        <div class="card" style="text-align: left;">
          <h3>U16 –¢–∞–∫—Ç–∏–∫–∞ 5‚Äì1</h3>
          <p class="meta">90 –º–∏–Ω ‚Ä¢ 7 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è ‚Ä¢ –∞–≤—Ç–æ—Ä: coach</p>
          <div class="tag-row">
            <span class="badge">–¶–µ–ª: –ë—ä—Ä–∑–∏ –∞—Ç–∞–∫–∏</span>
            <span class="badge success">–°—Ç–∞—Ç—É—Å: –û–¥–æ–±—Ä–µ–Ω–∞ –æ—Ç bfv_admin</span>
          </div>
        </div>
        <div class="card" style="text-align: left;">
          <h3>U12 –ó–∞–±–∞–≤–Ω–∞ –∑–∞–≥—Ä—è–≤–∫–∞</h3>
          <p class="meta">45 –º–∏–Ω ‚Ä¢ 4 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è ‚Ä¢ –∞–≤—Ç–æ—Ä: coach</p>
          <div class="tag-row">
            <span class="badge">–¶–µ–ª: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è</span>
            <span class="badge warning">–°—Ç–∞—Ç—É—Å: –ß–µ—Ä–Ω–æ–≤–∞</span>
          </div>
        </div>
      </div>
    </section>

    <section class="forum" aria-label="–û–¥–æ–±—Ä–µ–Ω–∏—è –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—è" id="approvals" style="margin-top: 20px;">
      <h2>–û–¥–æ–±—Ä–µ–Ω–∏—è (bfv_admin)</h2>
      <div class="grid">
        <div class="card" style="text-align: left;">
          <div class="badge warning">–ß–∞–∫–∞ –ø—Ä–µ–≥–ª–µ–¥</div>
          <h3>–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ: –ü–æ–¥–∞–≤–∞–Ω–µ –ø–æ –¥–∏–∞–≥–æ–Ω–∞–ª</h3>
          <p class="meta">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –æ—Ç coach ‚Ä¢ –ù–∏–≤–æ: U14 ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –¢–µ—Ö–Ω–∏–∫–∞</p>
          <button class="pill-btn" style="margin-top: 10px;">–û–¥–æ–±—Ä–∏</button>
          <button class="pill-btn ghost" style="margin-top: 8px;">–í—ä—Ä–Ω–∏ –∑–∞ –∫–æ—Ä–µ–∫—Ü–∏–∏</button>
        </div>
        <div class="card" style="text-align: left;">
          <div class="badge info">–°—Ç–∞—Ç–∏—è</div>
          <h3>–ú–µ—Ç–æ–¥–∏–∫–∞: –†–∞–±–æ—Ç–∞ —Å –ª–∏–±–µ—Ä–æ</h3>
          <p class="meta">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∞ –æ—Ç coach ‚Ä¢ –¢–∏–ø: PDF</p>
          <div class="tag-row">
            <span class="badge success">–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–∞–Ω–æ</span>
            <span class="badge">–°—Ä–æ–∫: 2 –¥–Ω–∏</span>
          </div>
        </div>
        <div class="card" style="text-align: left;">
          <div class="badge danger">–°–∏–≥–Ω–∞–ª –æ—Ç —Ñ–æ—Ä—É–º</div>
          <h3>–¢–µ–º–∞: –ò–Ω—Ç–µ–Ω–∑–∏–≤–Ω–æ—Å—Ç –ø—Ä–∏ U12</h3>
          <p class="meta">bfv_admin –º–æ–∂–µ –¥–∞ —Å–∫—Ä–∏–µ/–±–ª–æ–∫–∏—Ä–∞ –∞–≤—Ç–æ—Ä–∞</p>
          <button class="pill-btn ghost" style="margin-top: 10px;">–ü—Ä–µ–≥–ª–µ–¥–∞–π –º–æ–¥–µ—Ä–∞—Ü–∏—è</button>
        </div>
      </div>
    </section>

    <section class="forum" aria-label="–ü–æ—Ç–æ—Ü–∏ –ø–æ —Ä–æ–ª–∏" id="flows" style="margin-top: 20px;">
      <h2>–ë—ä—Ä–∑–∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏</h2>
      <div class="grid">
        <div class="card" style="text-align: left;">
          <h3>platform_admin</h3>
          <ul>
            <li>–°—ä–∑–¥–∞–≤–∞ –Ω–æ–≤ –∫–ª—É–± ‚Üí –Ω–∞–∑–Ω–∞—á–∞–≤–∞ bfv_admin.</li>
            <li>–î–æ–±–∞–≤—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äû–¢–∞–∫—Ç–∏–∫–∞ U16‚Äú ‚Üí –ø—É–±–ª–∏–∫—É–≤–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ.</li>
            <li>–ó–∞–∫—Ä–µ–ø–≤–∞ —Ç–µ–º–∞ –≤—ä–≤ —Ñ–æ—Ä—É–º–∞ –∑–∞ –ø—Ä–∞–≤–∏–ª–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç.</li>
          </ul>
        </div>
        <div class="card" style="text-align: left;">
          <h3>bfv_admin</h3>
          <ul>
            <li>–ü—Ä–µ–≥–ª–µ–∂–¥–∞ —á–∞–∫–∞—â–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –æ—Ç —Ç—Ä–µ–Ω—å–æ—Ä–∏ ‚Üí –æ–¥–æ–±—Ä—è–≤–∞ –∏–ª–∏ –≤—Ä—ä—â–∞.</li>
            <li>–ü—É–±–ª–∏–∫—É–≤–∞ —Å—Ç–∞—Ç–∏—è ‚Äû–ö–æ–Ω—Ç—Ä–∞–∞—Ç–∞–∫–∞‚Äú –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–∞ –æ–ø–∏—Å–∞–Ω–∏–µ—Ç–æ.</li>
            <li>–ú–æ–¥–µ—Ä–∏—Ä–∞ —Ñ–æ—Ä—É–º–Ω–∞ —Ç–µ–º–∞ —Å—ä—Å —Å–∏–≥–Ω–∞–ª.</li>
          </ul>
        </div>
        <div class="card" style="text-align: left;">
          <h3>coach</h3>
          <ul>
            <li>–§–∏–ª—Ç—Ä–∏—Ä–∞ –±–∞–∑–∞—Ç–∞ ‚Üí –¥–æ–±–∞–≤—è 5 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞.</li>
            <li>–ó–∞–ø–∞–∑–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∑–∞ –∫–ª—É–±–∞ ‚Üí –º–∞—Ä–∫–∏—Ä–∞ –∫–∞—Ç–æ ‚Äû–ß–µ—Ä–Ω–æ–≤–∞‚Äú.</li>
            <li>–ü—Ä–µ–¥–ª–∞–≥–∞ –Ω–æ–≤ –º–∞—Ç–µ—Ä–∏–∞–ª –∑–∞ –º–µ—Ç–æ–¥–∏–∫–∞—Ç–∞ ‚Üí —á–∞–∫–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ.</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer id="settings">
    Volley Platform ‚Äî 2025
  </footer>

  <div class="toast-area" id="toast-area" aria-live="polite"></div>

  <script>
    const apiInput = document.getElementById('api-url');
    const apiState = document.getElementById('api-state');
    const apiHint = document.getElementById('api-hint');
    const apiUpdated = document.getElementById('api-updated');
    const activeRoleBadge = document.getElementById('active-role-badge');
    const offlineFlag = document.getElementById('offline-flag');
    const resetBtn = document.getElementById('reset-api');
    const btn = document.getElementById('load-data');
    const coachBetaStatus = document.getElementById('coachBetaStatus');
    const roleSelect = document.getElementById('role-select');
    const roleSource = document.getElementById('role-source');
    const roleCan = document.getElementById('role-can');
    const roleActions = document.getElementById('role-actions');
    const toastArea = document.getElementById('toast-area');

    const API_STORAGE_KEY = 'volley_mock_api_base';

    function getStoredBase() {
      try {
        return localStorage.getItem(API_STORAGE_KEY) || '';
      } catch (err) {
        return '';
      }
    }

    function storeBase(base) {
      try {
        localStorage.setItem(API_STORAGE_KEY, base);
      } catch (err) {
        console.warn('Cannot store API base', err);
      }
    }

    function clearStoredBase() {
      try {
        localStorage.removeItem(API_STORAGE_KEY);
      } catch (err) {
        console.warn('Cannot clear API base', err);
      }
    }

    const defaultApiBase = (() => {
      try {
        if (window?.location?.protocol?.startsWith('http')) {
          return window.location.origin;
        }
      } catch (err) {
        console.warn('Cannot detect origin, using localhost', err);
      }
      return 'http://localhost:8001';
    })();

    const prefilledBase = normalizeBase(getStoredBase() || defaultApiBase);
    if (apiInput) {
      apiInput.value = prefilledBase;
    }
    if (apiHint) {
      apiHint.textContent = getStoredBase()
        ? '–ò–∑–ø–æ–ª–∑–≤–∞–º–µ –∑–∞–ø–∞–∑–µ–Ω–∏—è –∞–¥—Ä–µ—Å –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–æ—Ç–æ —Ç–µ—Å—Ç–≤–∞–Ω–µ'
        : `–ê–≤—Ç–æ-–ø–æ–ø—ä–ª–≤–∞–Ω–µ —Å–ø–æ—Ä–µ–¥ —Ç–µ–∫—É—â–∏—è –¥–æ–º–µ–π–Ω (${defaultApiBase})`;
    }

    const targets = {
      exercises: document.getElementById('api-exercises'),
      trainings: document.getElementById('api-trainings'),
      clubs: document.getElementById('api-clubs'),
      pending: document.getElementById('api-pending'),
      roles: document.getElementById('api-roles'),
    };
    const exerciseSearch = document.getElementById('exercise-search');
    const exerciseStatus = document.getElementById('exercise-status');
    const exerciseCategory = document.getElementById('exercise-category');
    const clubStatus = document.getElementById('club-status');
    const pendingType = document.getElementById('pending-type');
    const proposeName = document.getElementById('propose-name');
    const proposeCategory = document.getElementById('propose-category');
    const proposeBtn = document.getElementById('btn-propose');
    const pendingActions = document.getElementById('pending-actions');
    let roleCache = [];
    let activeRole = 'coach';
    let offlineChanges = [];
    let exerciseCache = [];
    let trainingCache = [];
    let clubCache = [];
    let pendingCache = { exercises: [], articles: [], forum_reports: [] };

    function normalizeBase(url) {
      const base = url || defaultApiBase;
      return base.endsWith('/') ? base.slice(0, -1) : base;
    }

    const statusIcons = {
      approved: '‚úÖ',
      pending: '‚è≥',
      draft: 'üìù',
      saved: 'üíæ',
      moderation: 'üõ°Ô∏è',
    };

    const fallback = {
      exercises: [
        { name: '–°–µ—Ä–≤–∏—Å –∑–æ–Ω–∞ 1', status: 'approved', owner: 'bfv_admin', category: '–°–µ—Ä–≤–∏—Å' },
        { name: '–ü–∞—Å —Å–ª–µ–¥ –ø—Ä–∏–µ–º', status: 'pending', owner: 'coach', category: '–ü–æ–¥–∞–≤–∞–Ω–µ' },
      ],
      trainings: [
        { name: 'U14 –¢–∞–∫—Ç–∏–∫–∞', status: 'saved', duration: 75 },
      ],
      clubs: [
        { name: '–ö–ª—É–± –°–æ—Ñ–∏—è', status: 'active', coaches: 3, coach_limit: 4, bfv_admin: 'bfv_admin.ivanova' },
        { name: '–ö–ª—É–± –ü–ª–æ–≤–¥–∏–≤', status: 'pending', coaches: 1, coach_limit: 4, bfv_admin: '‚Äî' },
      ],
      pending: {
        exercises: [{ name: '–í–∏–¥–µ–æ: –ö–æ–Ω—Ç—Ä–∞–∞—Ç–∞–∫–∞', type: 'exercise' }],
        articles: [{ name: 'PDF: –ü—Ä–∏–º–µ—Ä–Ω–∞ –º–µ—Ç–æ–¥–∏–∫–∞', type: 'article' }],
        forum_reports: [{ name: '–°–∏–≥–Ω–∞–ª –∑–∞ —Ç–µ–º–∞: ‚Äû–ù–µ–ø–æ–¥—Ö–æ–¥—è—â–æ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ‚Äú', type: 'forum' }],
      },
      roles: [
        {
          role: 'platform_admin',
          can: ['–∫–ª—É–±–æ–≤–µ', '–æ–¥–æ–±—Ä–µ–Ω–∏—è', '–º–µ—Ç–æ–¥–∏–∫–∞'],
          actions: ['–°—ä–∑–¥–∞–≤–∞ –∫–ª—É–± –∏ –Ω–∞–∑–Ω–∞—á–∞–≤–∞ bfv_admin', '–û–¥–æ–±—Ä—è–≤–∞ –æ—Ñ–∏—Ü–∏–∞–ª–Ω–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è'],
        },
        {
          role: 'bfv_admin',
          can: ['—É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è', '—Å—Ç–∞—Ç–∏–∏', '–º–æ–¥–µ—Ä–∞—Ü–∏—è'],
          actions: ['–ü—Ä–µ–≥–ª–µ–∂–¥–∞ —á–∞–∫–∞—â–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏–∏', '–ú–æ–¥–µ—Ä–∏—Ä–∞ —Ñ–æ—Ä—É–º–Ω–∏ —Å–∏–≥–Ω–∞–ª–∏'],
        },
        {
          role: 'coach',
          can: ['–≥–µ–Ω–µ—Ä–∏—Ä–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏', '–ø—Ä–µ–¥–ª–∞–≥–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è'],
          actions: ['–°—ä–∑–¥–∞–≤–∞ –∏ –∑–∞–ø–∞–∑–≤–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏', '–ü—Ä–µ–¥–ª–∞–≥–∞ –Ω–æ–≤–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –∑–∞ –æ–¥–æ–±—Ä–µ–Ω–∏–µ'],
        },
      ],
    };

    function populateCategories(items = []) {
      if (!exerciseCategory) return;
      const cats = new Set(['all']);
      items.forEach((x) => {
        if (x.category) cats.add((x.category || '').trim());
      });
      exerciseCategory.innerHTML = Array.from(cats)
        .map((c) => `<option value="${c.toLowerCase()}">${c === 'all' ? '–í—Å–∏—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' : c}</option>`)
        .join('');
    }

    function setStatus(message, color = '#475569') {
      apiState.textContent = message;
      apiState.style.color = color;
    }

    function setUpdated(source) {
      if (!apiUpdated) return;
      const now = new Date();
      const time = now.toLocaleTimeString('bg-BG', { hour: '2-digit', minute: '2-digit' });
      apiUpdated.textContent = `–ü–æ—Å–ª–µ–¥–Ω–æ –æ–±–Ω–æ–≤—è–≤–∞–Ω–µ: ${time} ‚Ä¢ ${source}`;
    }

    function setCoachBeta(message, color = '#0b2c3c', icon = '‚ÑπÔ∏è') {
      if (!coachBetaStatus) return;
      coachBetaStatus.innerHTML = `<span style="display:inline-flex;align-items:center;gap:6px;background:#e0f2fe;color:${color};padding:8px 12px;border-radius:12px;font-weight:600;">${icon} ${message}</span>`;
    }

    function setOffline(message = '') {
      if (offlineFlag) {
        offlineFlag.textContent = message;
        offlineFlag.style.color = message ? '#b91c1c' : '#475569';
      }
    }

    function showToast(message, type = 'info') {
      if (!toastArea) return;
      const div = document.createElement('div');
      div.className = `toast ${type}`;
      div.textContent = message;
      toastArea.appendChild(div);
      setTimeout(() => {
        div.classList.add('fade-out');
        div.style.opacity = '0';
        div.style.transition = 'opacity 0.4s ease';
        setTimeout(() => div.remove(), 500);
      }, 2400);
    }

    function renderList(items, target) {
      if (!target) return;
      const list = Array.isArray(items) && items.length ? items : ['–ù—è–º–∞ –¥–∞–Ω–Ω–∏'];
      target.innerHTML = list.map((x) => `<li>${x}</li>`).join('');
    }

    function updateRoleContext(role) {
      activeRole = role || activeRole || 'coach';
      if (activeRoleBadge) {
        activeRoleBadge.textContent = `–†–æ–ª—è: ${activeRole}`;
      }

      const canPropose = ['coach', 'bfv_admin'].includes(activeRole);
      if (proposeBtn) {
        proposeBtn.disabled = !canPropose;
        proposeBtn.title = canPropose ? '' : '–°–∞–º–æ coach/bfv_admin –º–æ–≥–∞—Ç –¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç';
      }
      if (proposeName) proposeName.disabled = !canPropose;
      if (proposeCategory) proposeCategory.disabled = !canPropose;

      const canApprove = ['bfv_admin', 'platform_admin'].includes(activeRole);
      if (pendingActions) {
        pendingActions.querySelectorAll('button[data-action]').forEach((btn) => {
          btn.disabled = !canApprove;
          btn.title = canApprove ? '' : '–°–∞–º–æ bfv_admin –∏–ª–∏ platform_admin –º–æ–≥–∞—Ç –¥–∞ –æ–¥–æ–±—Ä—è–≤–∞—Ç';
        });
      }
    }

    function renderRolePreview(roleName) {
      if (!roleCache?.length) {
        roleCache = fallback.roles;
      }
      const found = roleCache.find((r) => r.role === roleName || r.name === roleName) || roleCache[0];
      if (!found) return;
      const canList = found.can || found.permissions || [];
      const actions = found.actions || ['–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è', '–ó–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏'];
      renderList(canList, roleCan);
      renderList(actions, roleActions);
      if (roleSelect && found.role) {
        roleSelect.value = found.role;
      }
      updateRoleContext(found.role || found.name || 'coach');
    }

    function renderPills(items, mapper, targetEl) {
      if (!Array.isArray(items) || !items.length) {
        targetEl.innerHTML = '<span class="pill">–ù—è–º–∞ –¥–∞–Ω–Ω–∏</span>';
        return;
      }
      targetEl.innerHTML = items
        .map((item) => {
          const { label, detail, status } = mapper(item);
          const icon = status ? statusIcons[status] || '‚Ä¢' : '‚Ä¢';
          return `<span class="pill" aria-label="${label}">${icon} ${label}${detail ? ` ‚Äî ${detail}` : ''}</span>`;
        })
        .join('');
    }

    function applyExerciseFilters() {
      const term = (exerciseSearch?.value || '').toLowerCase();
      const status = (exerciseStatus?.value || 'all').toLowerCase();
      const cat = (exerciseCategory?.value || 'all').toLowerCase();
      const filtered = (exerciseCache || []).filter((x) => {
        const matchTerm = !term || (x.name || '').toLowerCase().includes(term);
        const matchStatus = status === 'all' || (x.status || '').toLowerCase() === status;
        const matchCat = cat === 'all' || (x.category || '').toLowerCase() === cat;
        return matchTerm && matchStatus && matchCat;
      });
      renderPills(
        filtered,
        (x) => ({
          label: x.name,
          detail: `${x.status || ''} ‚Ä¢ ${x.category || x.owner || '–±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏—è'}`.trim(),
          status: x.status,
        }),
        targets.exercises,
      );
    }

    function renderTrainings() {
      renderPills(
        trainingCache,
        (x) => ({ label: x.name, detail: `${x.status} ‚Ä¢ ${x.duration} –º–∏–Ω.`, status: x.status }),
        targets.trainings,
      );
    }

    function applyClubFilters() {
      const filterStatus = (clubStatus?.value || 'all').toLowerCase();
      const filtered = (clubCache || []).filter((c) => {
        const status = (c.status || '').toLowerCase();
        return filterStatus === 'all' || status === filterStatus;
      });
      renderPills(
        filtered,
        (x) => ({
          label: x.name,
          detail: `${x.status} ‚Ä¢ —Ç—Ä–µ–Ω—å–æ—Ä–∏ ${x.coaches || 0}/${x.coach_limit || 4}${x.bfv_admin ? ` ‚Ä¢ ${x.bfv_admin}` : ''}`,
          status: x.status === 'pending' ? 'pending' : 'approved',
        }),
        targets.clubs,
      );
    }

    function applyPendingFilters() {
      const filterType = (pendingType?.value || 'all').toLowerCase();
      const pendingItems = [];
      if (pendingCache?.exercises?.length) {
        pendingItems.push(
          ...pendingCache.exercises.map((x) => ({
            ...x,
            label: x.name,
            detail: `—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ‚Ä¢ ${x.proposed_by || 'coach'}`,
            status: 'pending',
            type: 'exercise',
          })),
        );
      }
      if (pendingCache?.articles?.length) {
        pendingItems.push(
          ...pendingCache.articles.map((x) => ({
            ...x,
            label: x.title || x.name,
            detail: `—Å—Ç–∞—Ç–∏—è ‚Ä¢ ${x.proposed_by || 'coach'}`,
            status: 'pending',
            type: 'article',
          })),
        );
      }
      if (pendingCache?.forum_reports?.length) {
        pendingItems.push(
          ...pendingCache.forum_reports.map((x) => ({
            ...x,
            label: x.topic || x.name,
            detail: `—Ñ–æ—Ä—É–º ‚Ä¢ ${x.reason || '—Å–∏–≥–Ω–∞–ª'}`,
            status: 'moderation',
            type: 'forum',
          })),
        );
      }

      const filtered = pendingItems.filter((p) => filterType === 'all' || (p.type || '').toLowerCase() === filterType);
      renderPills(
        filtered,
        (x) => ({
          label: x.label,
          detail: x.detail,
          status: x.status,
        }),
        targets.pending,
      );

      const exerciseOnly = filtered.filter((p) => p.type === 'exercise');
      if (pendingActions) {
        if (!exerciseOnly.length) {
          pendingActions.innerHTML = '<span class="pill">–ù—è–º–∞ —á–∞–∫–∞—â–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</span>';
        } else {
          pendingActions.innerHTML = exerciseOnly
            .map(
              (x) => `
                <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;">
                  <span class="pill" style="background:#fff;border:1px solid #e2e8f0;">‚è≥ ${x.label} ‚Äî ${x.detail}</span>
                  <div style="display:flex;gap:6px;">
                    <button data-action="approve" data-id="${x.id}" style="background:var(--success);color:#fff;border:none;padding:6px 10px;border-radius:10px;cursor:pointer;">–û–¥–æ–±—Ä–∏</button>
                    <button data-action="reject" data-id="${x.id}" style="background:var(--danger);color:#fff;border:none;padding:6px 10px;border-radius:10px;cursor:pointer;">–û—Ç–∫–∞–∂–∏</button>
                  </div>
                </div>
              `,
            )
            .join('');
          pendingActions.querySelectorAll('button[data-action]').forEach((btn) => {
            btn.addEventListener('click', (e) => handlePendingAction(e.target.dataset.action, Number(e.target.dataset.id)));
          });
          updateRoleContext(activeRole);
        }
      }
    }

    async function handlePendingAction(action, id) {
      if (!['bfv_admin', 'platform_admin'].includes(activeRole)) {
        showToast('–°–∞–º–æ bfv_admin –∏–ª–∏ platform_admin –º–æ–≥–∞—Ç –¥–∞ –æ–¥–æ–±—Ä—è–≤–∞—Ç/–æ—Ç–∫–∞–∑–≤–∞—Ç.', 'error');
        return;
      }
      if (!id || !['approve', 'reject'].includes(action)) return;
      const base = normalizeBase(apiInput?.value?.trim() || defaultApiBase);
      const url = `${base}/api/pending/exercises/${id}/${action}`;
      try {
        const res = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' } });
        if (!res.ok) throw new Error('API error');
        const data = await res.json();
        pendingCache.exercises = (pendingCache.exercises || []).filter((x) => x.id !== id);
        if (action === 'approve' && data?.item) {
          exerciseCache = [...exerciseCache, { ...data.item, status: data.item.status || 'approved' }];
        }
        applyExerciseFilters();
        applyPendingFilters();
        setStatus(`–£—Å–ø–µ—à–Ω–æ ${action === 'approve' ? '–æ–¥–æ–±—Ä–µ–Ω–∏–µ' : '–æ—Ç–∫–∞–∑'} —á—Ä–µ–∑ API`, '#166534');
        setUpdated(`API (${base})`);
        showToast('–î–µ–π—Å—Ç–≤–∏–µ—Ç–æ –µ –∑–∞–ø–∏—Å–∞–Ω–æ –∏ —Å–ø–∏—Å—ä—Ü–∏—Ç–µ —Å–∞ –æ–±–Ω–æ–≤–µ–Ω–∏.', 'success');
        await loadFromApi();
      } catch (err) {
        // Fallback –ª–æ–∫–∞–ª–Ω–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
        pendingCache.exercises = (pendingCache.exercises || []).filter((x) => x.id !== id);
        if (action === 'approve') {
          const fallbackItem = { id, name: `–û–¥–æ–±—Ä–µ–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ #${id}`, status: 'approved', category: '–û–±—â–æ' };
          exerciseCache = [...exerciseCache, fallbackItem];
        }
        applyExerciseFilters();
        applyPendingFilters();
        setStatus(`API –Ω–µ–¥–æ—Å—Ç—ä–ø–Ω–æ ‚Äî ${action} –∑–∞–ø–∏—Å–∞–Ω–æ –ª–æ–∫–∞–ª–Ω–æ`, '#b91c1c');
        offlineChanges.push({ type: action, id });
        setOffline('–ó–∞–ø–∏—Å–∞–Ω–æ –ª–æ–∫–∞–ª–Ω–æ (offline change)');
        showToast('API –Ω–µ–¥–æ—Å—Ç—ä–ø–Ω–æ ‚Äî –ø—Ä–æ–º—è–Ω–∞—Ç–∞ –µ —Å–∞–º–æ –ª–æ–∫–∞–ª–Ω–∞.', 'info');
      }
    }

    async function proposeExercise() {
      if (!['coach', 'bfv_admin'].includes(activeRole)) {
        showToast('–°–∞–º–æ coach –∏–ª–∏ bfv_admin –º–æ–≥–∞—Ç –¥–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.', 'error');
        return;
      }
      const name = (proposeName?.value || '').trim() || '–ù–æ–≤–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ';
      const category = (proposeCategory?.value || '–û–±—â–æ').trim();
      const base = normalizeBase(apiInput?.value?.trim() || defaultApiBase);
      const payload = { name, category, proposed_by: 'coach.demo' };
      try {
        const res = await fetch(`${base}/api/pending/exercises`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        });
        if (!res.ok) throw new Error('API error');
        const data = await res.json();
        const item = data?.item || payload;
        pendingCache.exercises = [...(pendingCache.exercises || []), item];
        applyPendingFilters();
        setStatus('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –∏–∑–ø—Ä–∞—Ç–µ–Ω–æ –∫—ä–º API (pending).', '#166534');
        setUpdated(`API (${base})`);
        showToast('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ API.', 'success');
        await loadFromApi();
      } catch (err) {
        const localItem = { id: Date.now(), name, category, proposed_by: 'coach.demo' };
        pendingCache.exercises = [...(pendingCache.exercises || []), localItem];
        applyPendingFilters();
        setStatus('API –Ω–µ–¥–æ—Å—Ç—ä–ø–Ω–æ ‚Äî –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –≤ –ª–æ–∫–∞–ª–Ω–∏—è pending —Å–ø–∏—Å—ä–∫.', '#b91c1c');
        offlineChanges.push({ type: 'propose', id: localItem.id });
        setOffline('–ó–∞–ø–∏—Å–∞–Ω–æ –ª–æ–∫–∞–ª–Ω–æ (offline change)');
        showToast('–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ—Ç–æ –µ –∑–∞–ø–∏—Å–∞–Ω–æ –ª–æ–∫–∞–ª–Ω–æ (offline).', 'info');
      }
    }

    async function loadFromApi() {
      const base = normalizeBase(apiInput?.value?.trim());
      if (!base) {
        setStatus('–î–æ–±–∞–≤–∏ –≤–∞–ª–∏–¥–µ–Ω URL', '#ef4444');
        setUpdated('–Ω—è–º–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ');
        return;
      }

      setStatus('–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...');
      try {
        const [exercises, trainings, clubs, pending, roles] = await Promise.all([
          fetch(`${base}/api/exercises`).then((r) => r.json()),
          fetch(`${base}/api/trainings`).then((r) => r.json()),
          fetch(`${base}/api/clubs`).then((r) => r.json()),
          fetch(`${base}/api/pending`).then((r) => r.json()),
          fetch(`${base}/api/roles`).then((r) => r.json()),
        ]);

        exerciseCache = Array.isArray(exercises) ? exercises : [];
        trainingCache = Array.isArray(trainings) ? trainings : [];
        clubCache = Array.isArray(clubs) ? clubs : [];
        pendingCache = pending || { exercises: [], articles: [], forum_reports: [] };

        populateCategories(exerciseCache);
        applyExerciseFilters();
        renderTrainings();
        applyClubFilters();
        applyPendingFilters();

        const rolesArr = Array.isArray(roles) ? roles : Object.values(roles || {});
        renderPills(
          rolesArr,
          (x) => ({
            label: x.role || x.name || 'role',
            detail: (x.can || x.permissions || [])
              .slice(0, 2)
              .join(', ')
              .trim() || '–ø—Ä–∞–≤–∞',
          }),
          targets.roles,
        );

        roleCache = rolesArr;
        if (roleSelect) {
          roleSelect.innerHTML = rolesArr
            .map((r) => `<option value="${r.role || r.name}">${r.role || r.name}</option>`)
            .join('');
        }
        if (roleSource) roleSource.textContent = '–ò–∑—Ç–æ—á–Ω–∏–∫: API –¥–∞–Ω–Ω–∏';
        renderRolePreview(roleSelect?.value || rolesArr[0]?.role);

        setStatus('–î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∑–∞—Ä–µ–¥–µ–Ω–∏ –æ—Ç API.');
        setUpdated(`API (${base})`);
        setCoachBeta('API –∞–∫—Ç–∏–≤–Ω–æ ‚Äî –≥–æ—Ç–æ–≤–æ –∑–∞ —Å–ø–æ–¥–µ–ª—è–Ω–µ —Å —Ç—Ä–µ–Ω—å–æ—Ä–∏', '#166534', '‚úÖ');
        setOffline('');
        offlineChanges = [];
        storeBase(base);
      } catch (err) {
        console.error(err);
        setStatus('API –Ω–µ–¥–æ—Å—Ç—ä–ø–Ω–æ ‚Äî –ø–æ–∫–∞–∑–≤–∞–º–µ –ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏.', '#ef4444');
        setCoachBeta('Fallback: –ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏ (API –Ω–µ–¥–æ—Å—Ç—ä–ø–Ω–æ)', '#b91c1c', '‚ö†Ô∏è');
        exerciseCache = fallback.exercises;
        trainingCache = fallback.trainings;
        clubCache = fallback.clubs;
        pendingCache = fallback.pending;

        populateCategories(exerciseCache);
        applyExerciseFilters();
        renderTrainings();
        applyClubFilters();
        applyPendingFilters();

        renderPills(
          fallback.roles,
          (x) => ({ label: x.role, detail: Array.isArray(x.can) ? x.can.join(', ') : x.can }),
          targets.roles,
        );

        roleCache = fallback.roles;
        if (roleSelect) {
          roleSelect.innerHTML = roleCache
            .map((r) => `<option value="${r.role}">${r.role}</option>`)
            .join('');
        }
        if (roleSource) roleSource.textContent = '–ò–∑—Ç–æ—á–Ω–∏–∫: –ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏';
        renderRolePreview(roleSelect?.value || roleCache[0]?.role);

        setOffline('–ò–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ –ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏ (offline —Ä–µ–∂–∏–º)');
        setUpdated('–ø—Ä–∏–º–µ—Ä–Ω–∏ –¥–∞–Ω–Ω–∏ (fallback)');
      }
    }

    btn?.addEventListener('click', loadFromApi);
    resetBtn?.addEventListener('click', () => {
      clearStoredBase();
      if (apiInput) {
        apiInput.value = normalizeBase(defaultApiBase);
      }
      if (apiHint) {
        apiHint.textContent = `–ê–≤—Ç–æ-–ø–æ–ø—ä–ª–≤–∞–Ω–µ —Å–ø–æ—Ä–µ–¥ —Ç–µ–∫—É—â–∏—è –¥–æ–º–µ–π–Ω (${defaultApiBase})`;
      }
      setStatus('–ü–æ–ª–µ—Ç–æ –µ –≤—ä—Ä–Ω–∞—Ç–æ –∫—ä–º –ª–æ–∫–∞–ª–Ω–∏—è –∞–¥—Ä–µ—Å.', '#0ea5e9');
      setUpdated('–∏–∑—á–∏—Å—Ç–µ–Ω–æ ‚Äî –ª–æ–∫–∞–ª–µ–Ω –∞–¥—Ä–µ—Å');
      setCoachBeta('–ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ –ª–æ–∫–∞–ª–µ–Ω –∞–¥—Ä–µ—Å –∏–ª–∏ –∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç –∑–∞ —Å–ø–æ–¥–µ–ª—è–Ω–µ', '#0b2c3c', '‚ÑπÔ∏è');
      setOffline('');
      offlineChanges = [];
    });
    roleSelect?.addEventListener('change', (e) => renderRolePreview(e.target.value));
    exerciseSearch?.addEventListener('input', applyExerciseFilters);
    exerciseStatus?.addEventListener('change', applyExerciseFilters);
    exerciseCategory?.addEventListener('change', applyExerciseFilters);
    clubStatus?.addEventListener('change', applyClubFilters);
    pendingType?.addEventListener('change', applyPendingFilters);
    proposeBtn?.addEventListener('click', proposeExercise);
    document.addEventListener('DOMContentLoaded', () => {
      roleCache = fallback.roles;
      if (roleSelect) {
        roleSelect.innerHTML = roleCache.map((r) => `<option value="${r.role}">${r.role}</option>`).join('');
      }
      renderRolePreview(roleSelect?.value || roleCache[0]?.role);
      setUpdated('–æ—á–∞–∫–≤–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ');
      setCoachBeta('–û—á–∞–∫–≤–∞ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ ‚Äî –≥–æ—Ç–æ–≤–æ –∑–∞ —Ç–µ—Å—Ç', '#0f172a', '‚è≥');
      loadFromApi();
    });
  </script>
</body>
</html>
